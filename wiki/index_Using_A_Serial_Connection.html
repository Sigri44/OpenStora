<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">
<head>
    <meta charset="UTF-8"/>
    <title>Using A Serial Connection - OpenStora</title>
    <meta name="generator" content="MediaWiki 1.22.6"/>
    <link rel="shortcut icon" href="/favicon.ico"/>
    <link rel="search" type="application/opensearchdescription+xml"
          href="https://sigri44.github.io/OpenStora/wiki/opensearch_desc.php" title="OpenStora (en)"/>
    <link rel="EditURI" type="application/rsd+xml" href="https://sigri44.github.io/OpenStora/wiki/api.php?action=rsd"/>
    <link rel="alternate" type="application/atom+xml" title="OpenStora Atom feed"
          href="https://sigri44.github.io/OpenStora/wiki/index_Special:RecentChanges&amp;feed=atom"/>
    <link rel="stylesheet" href="style.css"/>
    <meta name="ResourceLoaderDynamicStyles" content=""/>
    <style>a:lang(ar), a:lang(ckb), a:lang(kk-arab), a:lang(mzn), a:lang(ps), a:lang(ur) {
        text-decoration: none
    }

    /* cache key: hardwar6_wiki:resourceloader:filter:minify-css:7:a5305c32ce5719fffdb0ebb117d3d93a */</style>

    <script src="https://sigri44.github.io/OpenStora/wiki/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=vector&amp;*"></script>
    <script>if (window.mw) {
        mw.config.set({
            "wgCanonicalNamespace": "",
            "wgCanonicalSpecialPageName": false,
            "wgNamespaceNumber": 0,
            "wgPageName": "Using_A_Serial_Connection",
            "wgTitle": "Using A Serial Connection",
            "wgCurRevisionId": 799,
            "wgRevisionId": 799,
            "wgArticleId": 46,
            "wgIsArticle": true,
            "wgIsRedirect": false,
            "wgAction": "view",
            "wgUserName": null,
            "wgUserGroups": ["*"],
            "wgCategories": [],
            "wgBreakFrames": false,
            "wgPageContentLanguage": "en",
            "wgPageContentModel": "wikitext",
            "wgSeparatorTransformTable": ["", ""],
            "wgDigitTransformTable": ["", ""],
            "wgDefaultDateFormat": "dmy",
            "wgMonthNames": ["", "January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],
            "wgMonthNamesShort": ["", "Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
            "wgRelevantPageName": "Using_A_Serial_Connection",
            "wgIsProbablyEditable": false,
            "wgRestrictionEdit": [],
            "wgRestrictionMove": []
        });
    }</script>
    <script>if (window.mw) {
        mw.loader.implement("user.options", function () {
            mw.user.options.set({
                "ccmeonemails": 0,
                "cols": 80,
                "date": "default",
                "diffonly": 0,
                "disablemail": 0,
                "disablesuggest": 0,
                "editfont": "default",
                "editondblclick": 0,
                "editsection": 1,
                "editsectiononrightclick": 0,
                "enotifminoredits": 0,
                "enotifrevealaddr": 0,
                "enotifusertalkpages": 1,
                "enotifwatchlistpages": 0,
                "extendwatchlist": 0,
                "fancysig": 0,
                "forceeditsummary": 0,
                "gender": "unknown",
                "hideminor": 0,
                "hidepatrolled": 0,
                "imagesize": 2,
                "justify": 0,
                "math": 1,
                "minordefault": 0,
                "newpageshidepatrolled": 0,
                "nocache": 0,
                "noconvertlink": 0,
                "norollbackdiff": 0,
                "numberheadings": 0,
                "previewonfirst": 0,
                "previewontop": 1,
                "rcdays": 7,
                "rclimit": 50,
                "rememberpassword": 0,
                "rows": 25,
                "searchlimit": 20,
                "showhiddencats": 0,
                "shownumberswatching": 1,
                "showtoc": 1,
                "showtoolbar": 1,
                "skin": "vector",
                "stubthreshold": 0,
                "thumbsize": 2,
                "underline": 2,
                "uselivepreview": 0,
                "usenewrc": 0,
                "vector-simplesearch": 1,
                "watchcreations": 0,
                "watchdefault": 0,
                "watchdeletion": 0,
                "watchlistdays": 3,
                "watchlisthideanons": 0,
                "watchlisthidebots": 0,
                "watchlisthideliu": 0,
                "watchlisthideminor": 0,
                "watchlisthideown": 0,
                "watchlisthidepatrolled": 0,
                "watchmoves": 0,
                "wllimit": 250,
                "useeditwarning": 1,
                "prefershttps": 1,
                "language": "en",
                "variant-gan": "gan",
                "variant-iu": "iu",
                "variant-kk": "kk",
                "variant-ku": "ku",
                "variant-shi": "shi",
                "variant-sr": "sr",
                "variant-tg": "tg",
                "variant-uz": "uz",
                "variant-zh": "zh",
                "searchNs0": true,
                "searchNs1": false,
                "searchNs2": false,
                "searchNs3": false,
                "searchNs4": false,
                "searchNs5": false,
                "searchNs6": false,
                "searchNs7": false,
                "searchNs8": false,
                "searchNs9": false,
                "searchNs10": false,
                "searchNs11": false,
                "searchNs12": false,
                "searchNs13": false,
                "searchNs14": false,
                "searchNs15": false,
                "variant": "en"
            });
        }, {}, {});
        mw.loader.implement("user.tokens", function () {
            mw.user.tokens.set({"editToken": "+\\", "patrolToken": false, "watchToken": false});
        }, {}, {});
        /* cache key: hardwar6_wiki:resourceloader:filter:minify-js:7:5a69c7e0fa6557851b6dea8a62efaffb */
    }</script>
    <script>if (window.mw) {
        mw.loader.load(["mediawiki.page.startup", "mediawiki.legacy.wikibits", "mediawiki.legacy.ajax", "skins.vector.js"]);
    }</script>
    <!--[if lt IE 7]>
    <style type="text/css">body {
        behavior: url("https://sigri44.github.io/OpenStora/wiki/skins/vector/csshover.min.htc")
    }</style><![endif]--></head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Using_A_Serial_Connection skin-vector action-view vector-animateLayout">
<div id="mw-page-base" class="noprint"></div>
<div id="mw-head-base" class="noprint"></div>
<div id="content" class="mw-body" role="main">
    <a id="top"></a>
    <div id="mw-js-message" style="display:none;"></div>
    <h1 id="firstHeading" class="firstHeading" lang="en"><span dir="auto">Using A Serial Connection</span></h1>
    <div id="bodyContent">
        <div id="siteSub">From OpenStora</div>
        <div id="contentSub"></div>
        <div id="jump-to-nav" class="mw-jump">
            Jump to: <a href="#mw-navigation">navigation</a>, <a href="#p-search">search</a>
        </div>
        <div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><p>Updated 2nd August 2010: This is a work
            in progress, I am using this to record my progress with the Stora, and hopefully others will find this
            useful. If you brick your device then it is not my fault.
        </p>
            <p>Background/Objective
                The stora is the latest in a line of embedded-type devices that I have stuck debian/emdebian on:
            </p>
            <p>Linksys NSLU2
                Netgear WGT634U
                PCEngines Alix 3c
                O2 Joggler
            </p>
            <p>The Stora is the first of the list that can have large amounts of internal storage. I want to run as
                close to native debian as possible. I use Debian except where absolutely have to use something else. The
                instructions will assume you do the same.
            </p>
            <p><br/>
            </p>
            <div id="toc" class="toc">
                <div id="toctitle"><h2>Contents</h2></div>
                <ul>
                    <li class="toclevel-1 tocsection-1"><a href="#Purchase_Stora"><span class="tocnumber">1</span> <span
                            class="toctext">Purchase Stora</span></a></li>
                    <li class="toclevel-1 tocsection-2"><a href="#Serial_port"><span class="tocnumber">2</span> <span
                            class="toctext">Serial port</span></a></li>
                    <li class="toclevel-1 tocsection-3"><a href="#Accessing_uBoot"><span class="tocnumber">3</span>
                        <span class="toctext">Accessing uBoot</span></a></li>
                    <li class="toclevel-1 tocsection-4"><a href="#Preparing_the_emdebian.2Fdebian_file_system"><span
                            class="tocnumber">4</span> <span
                            class="toctext">Preparing the emdebian/debian file system</span></a></li>
                    <li class="toclevel-1 tocsection-5"><a href="#Stick_the_kernel_somewhere"><span
                            class="tocnumber">5</span> <span class="toctext">Stick the kernel somewhere</span></a></li>
                </ul>
            </div>

            <h2><span class="mw-headline" id="Purchase_Stora">Purchase Stora</span></h2>
            <p>A little while ago eBuyer were selling a 500GB Stora for Â£70 inc postage.
            </p>
            <h2><span class="mw-headline" id="Serial_port">Serial port</span></h2>
            <p><b> CAUTION: If you do not use this specific cable, </b>
            </p>
            <p><b> you need to make sure your cable is a LVTTL or </b>
            </p>
            <p><b> TTL level cable. A standard RS232 cable will </b>
            </p>
            <p><b> fry the Stora's main board.</b>
            </p>
            <p><br/>
                I purchased a nokia dku-5 for Â£2.98 including postage.
                <a rel="nofollow" class="external free" href="http://www.amazon.co.uk/gp/product/B00007BHPL">http://www.amazon.co.uk/gp/product/B00007BHPL</a>
                And a 4 pin header plug from e-bay.
                <a rel="nofollow" class="external free"
                   href="http://cgi.ebay.co.uk/ws/eBayISAPI.dll?ViewItem&amp;item=140376266229">http://cgi.ebay.co.uk/ws/eBayISAPI.dll?ViewItem&amp;item=140376266229</a>
            </p>
            <p>The DKU-5 is a serial to USB converter, which accepts the right voltages etc. I generally use a max232
                converter, but as virtually nothing has a serial port these days, this is a neater solution.
            </p>
            <p>Cut the proprietary Nokia connector off the end. Find that (contrary to internet sources) the cable has 3
                cables. These are (from memory, will check):
            </p>
            <ol>
                <li>Orange: Ground (pin nearest battery on stora)
                </li>
                <li>Red: TX (next pin to Orange)
                </li>
                <li>Blue: RX (next pin to red)
                </li>
            </ol>
            <p>If you use the crimps from the kit off e-bay, and stick them straight on the pins with some insulating
                tape to prevent shorts, then by bending the crimps slightly, you can get the back cover on. The cable
                can be threaded out of the case near the feet at the bottom, no external drilling etc necessary- nice!
            </p>
            <p>A DKU-5 bought in Australia had white (ground), black (TX), and red (RX) wires. Mis-wiring the white
                ground to +ve pin (4th pin) did not harm the board (phew).
            </p>
            <h2><span class="mw-headline" id="Accessing_uBoot">Accessing uBoot</span></h2>
            <p>Connect the USB connector to a machine of your choosing. Using 'dmesg' should show you which /dev/ttyUSB&lt;x&gt;
                the device has connected to. I used minicom or screen to connect to the port at '115200,8,N,1'.
            </p>
            <p>Start the stora. You should see the boot messages, when it says 'Press a key to interrupt autostart',
                press a key!
            </p>
            <p>Various parameters need to be set, these ones can be/need to be saved.
                setenv serverip &lt;ip of tftp server&gt;
                setenv ipaddr &lt;ip of stora&gt;
                setenv mainlineLinux yes
                setenv arcNumber 2734
                saveenv
                reset
            </p>
            <h2><span class="mw-headline" id="Preparing_the_emdebian.2Fdebian_file_system">Preparing the emdebian/debian file system</span>
            </h2>
            <p>I couldn't be bothered using NFS and all that, my plan is to just boot a kernel from tftp and use a local
                filesystem.
                Get the emdebian root file system, and unpack it onto a SATA disk, with ext3 (if you want you can have a
                swap-partition.
                You'll need to modify the following files(on the unpacked file system):
            </p>
            <p>/etc/fstab
                comment out the root file system and replace it with the partition with the unpacked file-system, on
                mine it was /dev/sdb2 (I left the original disk in place, and the swap was the first partition) so the
                line looked like:
            </p>
            <p><code>/dev/sdb2 / ext3 defaults 1 1</code>
            </p>
            <p>/etc/inittab
                The inittab file was not configured correctly to put a console/terminal on the serial port, so this
                needs to be modified. Find the lines that look like the below, and make them exactly like it!
            </p>
            <p><code># Example how to put a getty on a serial line (for a terminal)</code>
            </p>
            <p><code>#</code>
            </p>
            <p><code>T0:23:respawn:/sbin/getty -L ttyS0 115200,9600 vt100</code>
            </p>
            <p><code>#T1:23:respawn:/sbin/getty -L ttyS1 9600 vt100</code>
            </p>
            <p><br/>
                You can also comment out the 7 getty lines above, AFAIK they will do exactly nothing on a machine
                without a keyboard mouse etc.
            </p>
            <p>I also edited /etc/network/interfaces, so the interface uses DHCP. A static would probably be a good
                idea, this was just easier. You will need to change the IP. I haven't found the need to add the MAC
                address.
            </p>
            <p>If you can chroot into the image, you can set the root passwd. Otherwise put an ssh key in place.
            </p>
            <h2><span class="mw-headline" id="Stick_the_kernel_somewhere">Stick the kernel somewhere</span></h2>
            <p>On a machine on your local LAN configure your tftpd server (apt-get install atftpd)
                Copy the uImage.mainline out of the repository, into /var/lib/tftpboot/
            </p>
            <p>Step 4: Stick the drive in the machine, start it, and access uBoot
            </p>
            <p>to load the kernel off of the tftp server:
            </p>
            <p>tftpboot 0x800000 uImage.mainline
            </p>
            <p>setenv bootargs $(console) root=/dev/sdb2
            </p>
            <p>bootm 0x800000
            </p>
            <p>et voila!!
            </p>
            <p>Next: Trying to boot the debian kirkwood kernel.
            </p>
            <!--
            NewPP limit report
            CPU time usage: 0.014 seconds
            Real time usage: 0.018 seconds
            Preprocessor visited node count: 19/1000000
            Preprocessor generated node count: 24/1000000
            Postâexpand include size: 0/2097152 bytes
            Template argument size: 0/2097152 bytes
            Highest expansion depth: 2/40
            Expensive parser function count: 0/100
            -->

            <!-- Saved in parser cache with key hardwar6_wiki:pcache:idhash:46-0!*!*!!en!*!* and timestamp 20171202005539
             -->
        </div>
        <div class="printfooter">
            Retrieved from "<a href=/wiki/index_Using_A_Serial_Connection&amp;oldid=799">/wiki/index_Using_A_Serial_Connection&amp;oldid=799</a>"
        </div>
        <div id='catlinks' class='catlinks catlinks-allhidden'></div>
        <div class="visualClear"></div>
    </div>
</div>
<div id="mw-navigation">
    <h2>Navigation menu</h2>
    <div id="mw-head">
        <div id="p-personal" role="navigation" class="" aria-labelledby="p-personal-label">
            <h3 id="p-personal-label">Personal tools</h3>
            <ul>
                <li id="pt-login"><a
                        href="https://sigri44.github.io/OpenStora/wiki/index_Special:UserLogin&amp;returnto=Using+A+Serial+Connection"
                        title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a>
                </li>
            </ul>
        </div>
        <div id="left-navigation">
            <div id="p-namespaces" role="navigation" class="vectorTabs" aria-labelledby="p-namespaces-label">
                <h3 id="p-namespaces-label">Namespaces</h3>
                <ul>
                    <li id="ca-nstab-main" class="selected"><span><a
                            href="https://sigri44.github.io/OpenStora/wiki/index_Using_A_Serial_Connection"
                            title="View the content page [c]" accesskey="c">Page</a></span></li>
                    <li id="ca-talk" class="new"><span><a
                            href="https://sigri44.github.io/OpenStora/wiki/index_Talk:Using_A_Serial_Connection&amp;action=edit&amp;redlink=1"
                            title="Discussion about the content page [t]" accesskey="t">Discussion</a></span></li>
                </ul>
            </div>
            <div id="p-variants" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-variants-label">
                <h3 id="mw-vector-current-variant">
                </h3>
                <h3 id="p-variants-label"><span>Variants</span><a href="#"></a></h3>
                <div class="menu">
                    <ul>
                    </ul>
                </div>
            </div>
        </div>
        <div id="right-navigation">
            <div id="p-views" role="navigation" class="vectorTabs" aria-labelledby="p-views-label">
                <h3 id="p-views-label">Views</h3>
                <ul>
                    <li id="ca-view" class="selected"><span><a
                            href="https://sigri44.github.io/OpenStora/wiki/index_Using_A_Serial_Connection">Read</a></span>
                    </li>
                    <li id="ca-viewsource"><span><a
                            href="https://sigri44.github.io/OpenStora/wiki/index_Using_A_Serial_Connection&amp;action=edit"
                            title="This page is protected.&#10;You can view its source [e]"
                            accesskey="e">View source</a></span></li>
                    <li id="ca-history" class="collapsible"><span><a
                            href="https://sigri44.github.io/OpenStora/wiki/index_Using_A_Serial_Connection&amp;action=history"
                            title="Past revisions of this page [h]" accesskey="h">View history</a></span></li>
                </ul>
            </div>
            <div id="p-cactions" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-cactions-label">
                <h3 id="p-cactions-label"><span>Actions</span><a href="#"></a></h3>
                <div class="menu">
                    <ul>
                    </ul>
                </div>
            </div>
            <div id="p-search" role="search">
                <h3><label for="searchInput">Search</label></h3>
                <form action="https://sigri44.github.io/OpenStora/wiki/index.php" id="searchform">
                    <div id="simpleSearch">
                        <input name="search" placeholder="Search" title="Search OpenStora [f]" accesskey="f"
                               id="searchInput"/>
                        <button type="submit" name="button" title="Search the pages for this text" id="searchButton">
                            <img src="https://sigri44.github.io/OpenStora/wiki/skins/vector/images/search-ltr.png?303"
                                 alt="Search" width="12" height="13"/></button>
                        <input type='hidden' name="title" value="Special:Search"/>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <div id="mw-panel">
        <div id="p-logo" role="banner"><a style="background-image: url(/wiki/images/logo.png);"
                                          href="https://sigri44.github.io/OpenStora/wiki/index_Main_Page"
                                          title="Visit the main page"></a></div>
        <div class="portal" role="navigation" id='p-Website' aria-labelledby='p-Website-label'>
            <h3 id='p-Website-label'>Website</h3>
            <div class="body">
                <ul>
                    <li id="n-OpenStora-Home"><a href="https://sigri44.github.io/OpenStora/" rel="nofollow">OpenStora
                        Home</a></li>
                    <li id="n-OpenStora-Forum"><a href="https://sigri44.github.io/OpenStora/phpBB3" rel="nofollow">OpenStora
                        Forum</a></li>
                </ul>
            </div>
        </div>
        <div class="portal" role="navigation" id='p-Wiki' aria-labelledby='p-Wiki-label'>
            <h3 id='p-Wiki-label'>Wiki</h3>
            <div class="body">
                <ul>
                    <li id="n-Main-Page"><a href="https://sigri44.github.io/OpenStora/wiki/index_Main_Page">Main
                        Page</a></li>
                    <li id="n-Recent-changes"><a href=/wiki/index_Special:Recentchanges" rel="nofollow">Recent
                        changes</a></li>
                    <li id="n-Help"><a href="https://sigri44.github.io/OpenStora/wiki/index_Help">Help</a></li>
                </ul>
            </div>
        </div>
        <div class="portal" role="navigation" id='p-tb' aria-labelledby='p-tb-label'>
            <h3 id='p-tb-label'>Tools</h3>
            <div class="body">
                <ul>
                    <li id="t-whatlinkshere"><a
                            href="https://sigri44.github.io/OpenStora/wiki/index_Special:WhatLinksHere/Using_A_Serial_Connection"
                            title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
                    <li id="t-recentchangeslinked"><a
                            href="https://sigri44.github.io/OpenStora/wiki/index_Special:RecentChangesLinked/Using_A_Serial_Connection"
                            title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a>
                    </li>
                    <li id="t-specialpages"><a
                            href="https://sigri44.github.io/OpenStora/wiki/index_Special:SpecialPages"
                            title="A list of all special pages [q]" accesskey="q">Special pages</a></li>
                    <li id="t-print"><a
                            href="https://sigri44.github.io/OpenStora/wiki/index_Using_A_Serial_Connection&amp;printable=yes"
                            rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable
                        version</a></li>
                    <li id="t-permalink"><a
                            href="https://sigri44.github.io/OpenStora/wiki/index_Using_A_Serial_Connection&amp;oldid=799"
                            title="Permanent link to this revision of the page">Permanent link</a></li>
                    <li id="t-info"><a
                            href="https://sigri44.github.io/OpenStora/wiki/index_Using_A_Serial_Connection&amp;action=info">Page
                        information</a></li>
                </ul>
            </div>
        </div>
    </div>
</div>
<div id="footer" role="contentinfo">
    <ul id="footer-info">
        <li id="footer-info-lastmod"> This page was last modified on 18 June 2011, at 04:47.</li>
        <li id="footer-info-viewcount">This page has been accessed 13,497 times.</li>
    </ul>
    <ul id="footer-places">
        <li id="footer-places-privacy"><a href="https://sigri44.github.io/OpenStora/wiki/index_OpenStora:Privacy_policy"
                                          title="OpenStora:Privacy policy">Privacy policy</a></li>
        <li id="footer-places-about"><a href="https://sigri44.github.io/OpenStora/wiki/index_OpenStora:About"
                                        title="OpenStora:About">About OpenStora</a></li>
        <li id="footer-places-disclaimer"><a
                href="https://sigri44.github.io/OpenStora/wiki/index_OpenStora:General_disclaimer"
                title="OpenStora:General disclaimer">Disclaimers</a></li>
    </ul>
    <ul id="footer-icons" class="noprint">
        <li id="footer-poweredbyico">
            <a href="//www.mediawiki.org/"><img
                    src="https://sigri44.github.io/OpenStora/wiki/skins/common/images/poweredby_mediawiki_88x31.png"
                    alt="Powered by MediaWiki" width="88" height="31"/></a>
        </li>
    </ul>
    <div style="clear:both"></div>
</div>
<script>/*<![CDATA[*/
window.jQuery && jQuery.ready();/*]]>*/</script>
<script>if (window.mw) {
    mw.loader.state({"site": "loading", "user": "ready", "user.groups": "ready"});
}</script>
<script>if (window.mw) {
    mw.loader.load(["mediawiki.action.view.postEdit", "mediawiki.user", "mediawiki.hidpi", "mediawiki.page.ready", "mediawiki.searchSuggest", "skins.vector.collapsibleNav"], null, true);
}</script>
<script>if (window.mw) {
    mw.loader.state({"site": "ready"});
}</script>
<!-- Served in 0.171 secs. -->
</body>
</html>
