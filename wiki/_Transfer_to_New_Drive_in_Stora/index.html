<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">
<head>
<meta charset="UTF-8" /><title>Harddrive Recovery / Transfer to New Drive in Stora - OpenStora</title>
<meta name="generator" content="MediaWiki 1.22.6" />
<link rel="shortcut icon" href="/favicon.ico" />
<link rel="search" type="application/opensearchdescription+xml" href="https://sigri44.github.io/OpenStora/wiki/opensearch_desc.php" title="OpenStora (en)" />
<link rel="EditURI" type="application/rsd+xml" href="https://sigri44.github.io/OpenStora/wiki/api.php?action=rsd" />
<link rel="alternate" type="application/atom+xml" title="OpenStora Atom feed" href="https://sigri44.github.io/OpenStora/wiki/index_Special:RecentChanges&amp;feed=atom" />
<link rel="stylesheet" href="style.css" />
<meta name="ResourceLoaderDynamicStyles" content="" />
<style>a:lang(ar),a:lang(ckb),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}
/* cache key: hardwar6_wiki:resourceloader:filter:minify-css:7:a5305c32ce5719fffdb0ebb117d3d93a */</style>

<script src="https://sigri44.github.io/OpenStora/wiki/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=vector&amp;*"></script>
<script>if(window.mw){
mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Harddrive_Recovery_/_Transfer_to_New_Drive_in_Stora","wgTitle":"Harddrive Recovery / Transfer to New Drive in Stora","wgCurRevisionId":1100,"wgRevisionId":1100,"wgArticleId":110,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Harddrive_Recovery_/_Transfer_to_New_Drive_in_Stora","wgIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[]});
}</script><script>if(window.mw){
mw.loader.implement("user.options",function(){mw.user.options.set({"ccmeonemails":0,"cols":80,"date":"default","diffonly":0,"disablemail":0,"disablesuggest":0,"editfont":"default","editondblclick":0,"editsection":1,"editsectiononrightclick":0,"enotifminoredits":0,"enotifrevealaddr":0,"enotifusertalkpages":1,"enotifwatchlistpages":0,"extendwatchlist":0,"fancysig":0,"forceeditsummary":0,"gender":"unknown","hideminor":0,"hidepatrolled":0,"imagesize":2,"justify":0,"math":1,"minordefault":0,"newpageshidepatrolled":0,"nocache":0,"noconvertlink":0,"norollbackdiff":0,"numberheadings":0,"previewonfirst":0,"previewontop":1,"rcdays":7,"rclimit":50,"rememberpassword":0,"rows":25,"searchlimit":20,"showhiddencats":0,"shownumberswatching":1,"showtoc":1,"showtoolbar":1,"skin":"vector","stubthreshold":0,"thumbsize":2,"underline":2,"uselivepreview":0,"usenewrc":0,"vector-simplesearch":1,"watchcreations":0,"watchdefault":0,"watchdeletion":0,"watchlistdays":3,"watchlisthideanons":0,"watchlisthidebots":0,
"watchlisthideliu":0,"watchlisthideminor":0,"watchlisthideown":0,"watchlisthidepatrolled":0,"watchmoves":0,"wllimit":250,"useeditwarning":1,"prefershttps":1,"language":"en","variant-gan":"gan","variant-iu":"iu","variant-kk":"kk","variant-ku":"ku","variant-shi":"shi","variant-sr":"sr","variant-tg":"tg","variant-uz":"uz","variant-zh":"zh","searchNs0":true,"searchNs1":false,"searchNs2":false,"searchNs3":false,"searchNs4":false,"searchNs5":false,"searchNs6":false,"searchNs7":false,"searchNs8":false,"searchNs9":false,"searchNs10":false,"searchNs11":false,"searchNs12":false,"searchNs13":false,"searchNs14":false,"searchNs15":false,"variant":"en"});},{},{});mw.loader.implement("user.tokens",function(){mw.user.tokens.set({"editToken":"+\\","patrolToken":false,"watchToken":false});},{},{});
/* cache key: hardwar6_wiki:resourceloader:filter:minify-js:7:5a69c7e0fa6557851b6dea8a62efaffb */
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.page.startup","mediawiki.legacy.wikibits","mediawiki.legacy.ajax","skins.vector.js"]);
}</script>
<!--[if lt IE 7]><style type="text/css">body{behavior:url("https://sigri44.github.io/OpenStora/wiki/skins/vector/csshover.min.htc")}</style><![endif]--></head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Harddrive_Recovery_Transfer_to_New_Drive_in_Stora skin-vector action-view vector-animateLayout">
		<div id="mw-page-base" class="noprint"></div>
		<div id="mw-head-base" class="noprint"></div>
		<div id="content" class="mw-body" role="main">
			<a id="top"></a>
			<div id="mw-js-message" style="display:none;"></div>
						<h1 id="firstHeading" class="firstHeading" lang="en"><span dir="auto">Harddrive Recovery / Transfer to New Drive in Stora</span></h1>
			<div id="bodyContent">
								<div id="siteSub">From OpenStora</div>
								<div id="contentSub"></div>
												<div id="jump-to-nav" class="mw-jump">
					Jump to:					<a href="#mw-navigation">navigation</a>, 					<a href="#p-search">search</a>
				</div>
				<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><p><b>Introduction</b>
</p><p>So you want to upgrade your 1TB drive to a 2Tb drive and move your files across to the new drive.  It can be done without backup however be warned:
</p><p>- this worked for me on my Stora with Firmware revision 2.5.1
</p><p>- you will lose customisations where these are saved to the hardrive
</p><p>- this method is best for a few large directories; not complex multiaccount many directory systems (which can be tedious to copy and reconfigure)
</p><p>- you may loose everything if something goes wrong
</p><p><b>Instructions</b>
</p><p>Remove your existing drive
Insert your new drive
Login to the web interface
Goto Disk Management
Select Configure New Drive
</p><p>you now have a 2TB Stora
</p><p>Login using SSH and use the All-in-one setup script to reconfigure as you desire
(get root access if you havebnt already)
As a minimum
</p>
<pre> - set PATH
 - Swap the SSH Daemon
 - IPKG
 - Move /opt
 - Install midnightcommander file manager(ipkg install mc)
</pre>
<p>Now familiarise yourself with mc lest you do damage.  RTFM!!!
</p><p>Insert you original drive into slot 2.  
In the web interface you will be prompted to configure the new drive DO NOT DO THIS&#160;!!!!!! Stora is trying to RAID the drive.  Cancel or you will loose your data.  It may reprompt you DO NOT CONFIGURE THE DRIVE!!!!!
</p><p>Now using SSH, mount the original drive to a directory called recover in your "FamilyLibrary".
</p><p>cd /home/0common
</p><p>mkdir recover
</p><p>mount /dev/sdb1 recover
</p><p><br />
You can now access the contents of your original drive at /home/0common/recover.
</p><p>Using mc, I suggest you copy the files you want to retain to a new directory on the larger drive (eg to another directory in the FamilyLibrary, then move them using renmov in mc to the desired location on the larger drive.  Two reasons for this:
</p><p>1. Copy instead of move, since move deletes from the original drive which it may be better not to do just yet.
</p><p>2. It will still take about 20-24 hours to copy 1TB from drive to drive (about 13.5 MB/s - much faster than using a USB drive).  Renmov using mc is almost instantaneous when moving on the same drive.  (Do not do this using a PC across the network as it deeats the purpose).
</p><p>Be careful entering the paths in mc.  Review the Stora directory structure, particularly the "FamilyLibrary" which is actually /home/0common.
</p><p>It may be possible to copy the changes you had previously made to your Stora since the full filesystem is visible on the original drive.  I didnt do this and started again with clean Stora.
</p><p><b>Update from 5.2.2012 by czernitko</b>
</p><p>Note 1: if you leave your stora without any harddrive, then plugging in the first drive (in any slot) will result in Stora rebuilding your drive WITHOUT ASKING!... Only when inserting the second drive you have the option not to add the drive to a raid array.
</p><p>Note 2: if you have lost your Stora (mine had gone for repairs due to NAND damage and I was left just with my two 2TB drives), you might need to access your data. First thought&#160;: just plug the drive into a running linux machine, mount the partition and you are good to go. Too simple, you say? Well, you cannot directly mount the drive, because it is a raid member. I have written a little howto for <a rel="nofollow" class="external text" href="https://sites.google.com/site/czernitko/linux/netgear-stora/recovering-data-from-disks">mounting harddrives from Stora on another running linux distribution</a>. Hope it helps.
</p>
<h2><span class="mw-headline" id="Alternative_method">Alternative method</span></h2>
<p>One of my 1TB drives got broken, but I have a raid 1 system, so why not use this raid functionality?
Now larger drives are cheap, so I wanted to expand the array to 2TB as well. This is the steps I took:
</p>
<ul>
<li> Turn off the system and eject the bad drive or keep one as a backup.
</li>
<li> Insert a new disc in the right bay, put the working drive in the left bay.
</li>
<li> Start the system, it should start up with the light for the right drive red.
</li>
<li> Log on to the WEB interface, now you should be asked to add the new drive. It is OK to do this, but you will get a warning that the full capacity of the new drive can't be used.
</li>
<li> Alternatively (not tried), create a partition on the new drive /dev/sdb covering the complete drive using Id fd (Linux raid autodetect). This should allow you to repartition this drive later. Use sudo fdisk /dev/sdb. After this add the new drive as described in the step above.
</li>
<li> Wait for raid stack to recreate, this will take several hours. You can check the status under disk management in the Web interface or use cat /proc/mdstat
</li>
<li> Turn off the system. Move the first new drive from right bay to left bay and insert the second drive in the right bay.
</li>
<li> Turn on the system and add the new drive to the array as described above.
</li>
<li> After resyncing, you should have a new system with the same size as before. Now it's time to increase the size.
</li>
<li> Check the partition sizes with sudo fdisk -l /dev/sda and sudo fdisk -l /dev/sdb. On my system /dev/sda had a partition sda1 of half the size as the disk, so this need to be repartitioned. If both use the full disk you can skip next steps.
<ul>
<li> Eject /dev/sda1 fom the array with sudo mdadm -f /dev/md0 /dev/sda1 followed by sudo mdadm -r /dev/md0 /dev/sda1
</li>
<li> Repartition sda1 by using sudo fdisk /dev/sda, remove the partition and create a new one using the complete drive. set the Id to fd (Linux Raid autodetect). Don't forget to save the partition table.
</li>
<li> Reinsert /dev/sda1 into the array with sudo mdadm --add /dev/md0 /dev/sda1
</li>
<li> Wait again for the array to resync (check with cat /proc/mdstat).
</li>
</ul>
</li>
<li> Now you should have full partition sizes on both drives. Increase the raid system with sudo mdadm --grow /dev/md0 --size max
</li>
<li> Again wait for the array to resync.
</li>
<li> Finally grow the filesystem using sudo xfs_growfs -d /dev/md0
</li>
<li> You are done having a new raid system with 2TB of space!
</li>
</ul>
<p>--<a href="https://sigri44.github.io/OpenStora/wiki/index_User:Bimme&amp;action=edit&amp;redlink=1" class="new" title="User:Bimme (page does not exist)">Bimme</a> (<a href="https://sigri44.github.io/OpenStora/wiki/index_User_talk:Bimme&amp;action=edit&amp;redlink=1" class="new" title="User talk:Bimme (page does not exist)">talk</a>) 16:17, 4 December 2014 (MST)
</p>
<!-- 
NewPP limit report
CPU time usage: 0.015 seconds
Real time usage: 0.018 seconds
Preprocessor visited node count: 3/1000000
Preprocessor generated node count: 8/1000000
Post‐expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 2/40
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key hardwar6_wiki:pcache:idhash:110-0!*!0!*!*!*!* and timestamp 20171202101033
 -->
</div>								<div class="printfooter">
				Retrieved from "<a href=/wiki/index_Harddrive_Recovery_/_Transfer_to_New_Drive_in_Stora&amp;oldid=1100">/wiki/index_Harddrive_Recovery_/_Transfer_to_New_Drive_in_Stora&amp;oldid=1100</a>"				</div>
												<div id='catlinks' class='catlinks catlinks-allhidden'></div>												<div class="visualClear"></div>
							</div>
		</div>
		<div id="mw-navigation">
			<h2>Navigation menu</h2>
			<div id="mw-head">
				<div id="p-personal" role="navigation" class="" aria-labelledby="p-personal-label">
	<h3 id="p-personal-label">Personal tools</h3>
	<ul>
<li id="pt-login"><a href="https://sigri44.github.io/OpenStora/wiki/index_Special:UserLogin&amp;returnto=Harddrive+Recovery+%2F+Transfer+to+New+Drive+in+Stora" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>	</ul>
</div>
				<div id="left-navigation">
					<div id="p-namespaces" role="navigation" class="vectorTabs" aria-labelledby="p-namespaces-label">
	<h3 id="p-namespaces-label">Namespaces</h3>
	<ul>
					<li  id="ca-nstab-main" class="selected"><span><a href="https://sigri44.github.io/OpenStora/wiki/index_Harddrive_Recovery_/_Transfer_to_New_Drive_in_Stora"  title="View the content page [c]" accesskey="c">Page</a></span></li>
					<li  id="ca-talk" class="new"><span><a href="https://sigri44.github.io/OpenStora/wiki/index_Talk:Harddrive_Recovery_/_Transfer_to_New_Drive_in_Stora&amp;action=edit&amp;redlink=1"  title="Discussion about the content page [t]" accesskey="t">Discussion</a></span></li>
			</ul>
</div>
<div id="p-variants" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-variants-label">
	<h3 id="mw-vector-current-variant">
		</h3>
	<h3 id="p-variants-label"><span>Variants</span><a href="#"></a></h3>
	<div class="menu">
		<ul>
					</ul>
	</div>
</div>
				</div>
				<div id="right-navigation">
					<div id="p-views" role="navigation" class="vectorTabs" aria-labelledby="p-views-label">
	<h3 id="p-views-label">Views</h3>
	<ul>
					<li id="ca-view" class="selected"><span><a href="https://sigri44.github.io/OpenStora/wiki/index_Harddrive_Recovery_/_Transfer_to_New_Drive_in_Stora" >Read</a></span></li>
					<li id="ca-viewsource"><span><a href="https://sigri44.github.io/OpenStora/wiki/index_Harddrive_Recovery_/_Transfer_to_New_Drive_in_Stora&amp;action=edit"  title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></span></li>
					<li id="ca-history" class="collapsible"><span><a href="https://sigri44.github.io/OpenStora/wiki/index_Harddrive_Recovery_/_Transfer_to_New_Drive_in_Stora&amp;action=history"  title="Past revisions of this page [h]" accesskey="h">View history</a></span></li>
			</ul>
</div>
<div id="p-cactions" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-cactions-label">
	<h3 id="p-cactions-label"><span>Actions</span><a href="#"></a></h3>
	<div class="menu">
		<ul>
					</ul>
	</div>
</div>
<div id="p-search" role="search">
	<h3><label for="searchInput">Search</label></h3>
	<form action="https://sigri44.github.io/OpenStora/wiki/index.php" id="searchform">
				<div id="simpleSearch">
						<input name="search" placeholder="Search" title="Search OpenStora [f]" accesskey="f" id="searchInput" />						<button type="submit" name="button" title="Search the pages for this text" id="searchButton"><img src="https://sigri44.github.io/OpenStora/wiki/skins/vector/images/search-ltr.png?303" alt="Search" width="12" height="13" /></button>								<input type='hidden' name="title" value="Special:Search"/>
		</div>
	</form>
</div>
				</div>
			</div>
			<div id="mw-panel">
					<div id="p-logo" role="banner"><a style="background-image: url(/wiki/images/logo.png);" href="https://sigri44.github.io/OpenStora/wiki/index_Main_Page"  title="Visit the main page"></a></div>
				<div class="portal" role="navigation" id='p-Website' aria-labelledby='p-Website-label'>
	<h3 id='p-Website-label'>Website</h3>
	<div class="body">
		<ul>
			<li id="n-OpenStora-Home"><a href="https://sigri44.github.io/OpenStora/" rel="nofollow">OpenStora Home</a></li>
			<li id="n-OpenStora-Forum"><a href="https://sigri44.github.io/OpenStora/phpBB3" rel="nofollow">OpenStora Forum</a></li>
		</ul>
	</div>
</div>
<div class="portal" role="navigation" id='p-Wiki' aria-labelledby='p-Wiki-label'>
	<h3 id='p-Wiki-label'>Wiki</h3>
	<div class="body">
		<ul>
			<li id="n-Main-Page"><a href="https://sigri44.github.io/OpenStora/wiki/index_Main_Page">Main Page</a></li>
			<li id="n-Recent-changes"><a href=/wiki/index_Special:Recentchanges" rel="nofollow">Recent changes</a></li>
			<li id="n-Help"><a href="https://sigri44.github.io/OpenStora/wiki/index_Help">Help</a></li>
		</ul>
	</div>
</div>
<div class="portal" role="navigation" id='p-tb' aria-labelledby='p-tb-label'>
	<h3 id='p-tb-label'>Tools</h3>
	<div class="body">
		<ul>
			<li id="t-whatlinkshere"><a href="https://sigri44.github.io/OpenStora/wiki/index_Special:WhatLinksHere/Harddrive_Recovery_/_Transfer_to_New_Drive_in_Stora" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
			<li id="t-recentchangeslinked"><a href="https://sigri44.github.io/OpenStora/wiki/index_Special:RecentChangesLinked/Harddrive_Recovery_/_Transfer_to_New_Drive_in_Stora" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
			<li id="t-specialpages"><a href="https://sigri44.github.io/OpenStora/wiki/index_Special:SpecialPages" title="A list of all special pages [q]" accesskey="q">Special pages</a></li>
			<li id="t-print"><a href="https://sigri44.github.io/OpenStora/wiki/index_Harddrive_Recovery_/_Transfer_to_New_Drive_in_Stora&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>
			<li id="t-permalink"><a href="https://sigri44.github.io/OpenStora/wiki/index_Harddrive_Recovery_/_Transfer_to_New_Drive_in_Stora&amp;oldid=1100" title="Permanent link to this revision of the page">Permanent link</a></li>
			<li id="t-info"><a href="https://sigri44.github.io/OpenStora/wiki/index_Harddrive_Recovery_/_Transfer_to_New_Drive_in_Stora&amp;action=info">Page information</a></li>
		</ul>
	</div>
</div>
			</div>
		</div>
		<div id="footer" role="contentinfo">
							<ul id="footer-info">
											<li id="footer-info-lastmod"> This page was last modified on 4 December 2014, at 16:17.</li>
											<li id="footer-info-viewcount">This page has been accessed 12,361 times.</li>
									</ul>
							<ul id="footer-places">
											<li id="footer-places-privacy"><a href="https://sigri44.github.io/OpenStora/wiki/index_OpenStora:Privacy_policy" title="OpenStora:Privacy policy">Privacy policy</a></li>
											<li id="footer-places-about"><a href="https://sigri44.github.io/OpenStora/wiki/index_OpenStora:About" title="OpenStora:About">About OpenStora</a></li>
											<li id="footer-places-disclaimer"><a href="https://sigri44.github.io/OpenStora/wiki/index_OpenStora:General_disclaimer" title="OpenStora:General disclaimer">Disclaimers</a></li>
									</ul>
										<ul id="footer-icons" class="noprint">
					<li id="footer-poweredbyico">
						<a href="//www.mediawiki.org/"><img src="https://sigri44.github.io/OpenStora/wiki/skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" width="88" height="31" /></a>
					</li>
				</ul>
						<div style="clear:both"></div>
		</div>
		<script>/*<![CDATA[*/window.jQuery && jQuery.ready();/*]]>*/</script><script>if(window.mw){
mw.loader.state({"site":"loading","user":"ready","user.groups":"ready"});
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.action.view.postEdit","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest","skins.vector.collapsibleNav"],null,true);
}</script>
<script>if(window.mw){
mw.loader.state({"site":"ready"});
}</script>
<!-- Served in 0.179 secs. -->
	</body>
</html>
